# 实施计划文档：Text2Poster Generator

本文档根据 `design.md` 的规划，将项目分解为具体、可执行的步骤。

## 🗓️ 阶段一：环境准备与模板搭建 (预计 1-2 小时)

此阶段的目标是搭建项目基础，包括创建必要的文件和目录，并完成静态网页模板的设计。

- [x] **1. 初始化项目结构**:
    - [x] 创建 Git 仓库 (`.git` 已存在)
    - [x] 创建 `output` 文件夹，用于存放生成的图片。
    - [x] 创建 `input.txt` 文件，并填入 3-5 条示例文本，每行一条。
    - [x] 创建 `main.py`，作为核心逻辑脚本文件。

- [x] **2. 安装依赖**:
    - [x] 在 `requirements.txt` 中添加 `playwright`。
    - [x] 执行 `pip install -r requirements.txt` 安装依赖。
    - [x] 执行 `playwright install` 下载浏览器驱动。

- [x] **3. HTML 模板设计 (`index.html`)**:
    - [x] 创建 `index.html` 文件。
    - [x] 基于 `Reference-style` 中的图片，设计 HTML 结构。关键元素包括一个用于包裹海报的容器 `div` (例如, `id="poster"`) 和一个用于动态填充文本的 `p` 或 `div` (例如, `id="text-container"`)。

- [x] **4. CSS 样式开发 (`style.css`)**:
    - [x] 创建 `style.css` 文件。
    - [x] 编写 CSS 规则，实现以下视觉效果：
        - **背景**: 设置与参考图片相似的渐变或纯色背景。
        - **布局**: 使用 Flexbox 或 Grid 实现文字的垂直和水平居中。
        - **字体**: 引入一款开源的圆体字体（例如，通过 Google Fonts），并设置字体大小、颜色和行间距。
        - **尺寸**: 为海报容器 `#poster` 设置固定的宽高（例如 `1080x1440` 像素）。
    - [x] 在 `index.html` 中链接 `style.css`。

## 🚀 阶段二：核心脚本开发 (预计 3-5 小时)

此阶段专注于 `main.py` 的编写，并引入 **JavaScript** 来实现动态内容分页，这是实现新需求的核心。

- [x] **1. 读取输入文件**:
    - [x] 保持不变：读取 `input.txt`，将每行文字存入列表。

- [ ] **2. 升级 HTML/CSS 模板**:
    - [ ] 在 `style.css` 中，定义两种不同的样式：
        - **封面页样式** (`.poster-cover`): 用于系列图片的第一张，设计可以更醒目。
        - **内页样式** (`.poster-content`): 用于后续页面，版式可能更简洁，专注于内容呈现。
    - [ ] 在 `index.html` 中，为海报容器添加一个默认的 class，例如 `class="poster-cover"`。

- [ ] **3. 编写内容分页的 JavaScript 逻辑**:
    - [ ] 创建一个新的 `pagination.js` 文件（或在 `main.py` 中以字符串形式管理）。
    - [ ] 编写一个 JS 函数，该函数负责：
        - 接收完整的文本内容。
        - 将文本逐字或逐词添加到海报的文本容器中。
        - 持续检测文本容器的 `scrollHeight` 是否超过其 `clientHeight`。
        - 当内容溢出时，记录下溢出点的前一个字符位置，并将该点前的所有内容作为“一页”。
        - 重复此过程，直到所有文本都被分割成“页”的数组。
        - 返回这个包含多页文本内容的数组。

- [ ] **4. 改造 Playwright 核心逻辑 (`main.py`)**:
    - [ ] 导入 `playwright` 并初始化浏览器。
    - [ ] 遍历从 `input.txt` 读取的文本列表（我们称之为“文章”）。
    - [ ] **对于每一篇文章**:
        - [ ] 打开 `index.html` 页面。
        - [ ] 使用 `page.evaluate()` 执行第 3 步中编写的 JS 分页函数，将当前文章的完整文本传入，并获取返回的文本页数组。
        - [ ] **生成封面页**:
            - [ ] 使用 `page.locator().fill()` 将数组的第一页文本填入。
            - [ ] 确保海报容器拥有 `.poster-cover` 样式。
            - [ ] 截图并保存为 `article_01_cover.png`。
        - [ ] **生成内页 (如果有多页)**:
            - [ ] 遍历文本数组的剩余部分。
            - [ ] 对于每一页文本：
                - [ ] 使用 JS 修改海报容器的 class 为 `.poster-content`。
                - [ ] 将当前页的文本填入。
                - [ ] 截图并保存为 `article_01_content_01.png`, `article_01_content_02.png`...

- [ ] **5. 完善与收尾**:
    - [ ] 确保浏览器正确关闭。
    - [ ] 更新 print 语句，以反映新的多页生成流程（例如 "正在生成文章 1 的封面..."，"正在生成文章 1 的第 2 页..."）。

## 🧪 阶段三：测试、优化与文档编写 (预计 2-3 小时)

此阶段的目标是验证更复杂的输出、进行微调，并完成所有必要的项目文档。

- [ ] **1. 测试与验证**:
    - [ ] 准备包含不同长度文本的 `input.txt`（短文本、刚好一页的文本、超长文本）。
    - [ ] 运行 `main.py`，检查以下情况：
        - [ ] 短文本是否只生成一张封面图。
        - [ ] 长文本是否按预期生成了“1张封面 + N张内页”。
        - [ ] 封面页和内页的样式是否正确应用。
        - [ ] 文件命名是否规范。

- [ ] **2. 迭代优化**:
    - [ ] **JS 分页逻辑优化**: 微调 JS 代码，确保文本分割点是句子结尾或单词之间，避免将单词从中间断开。
    - [ ] **CSS 样式微调**: 根据测试结果，调整 `style.css` 中的两种样式，达到最佳视觉效果。

- [x] **3. 编写文档**:
    - [x] 创建并完成 `manual.md`，清晰地说明如何安装依赖、准备 `input.txt` 以及如何运行 `main.py` 脚本。
    - [x] 创建 `dev_log.md`，记录开发过程中的关键步骤和决策。
    - [x] 创建 `experience.md`，总结本次使用 Gemini CLI + Playwright MCP 的开发经验和思考。

- [ ] **4. 版本控制**:
    - [ ] 使用 `git add .` 将所有项目文件添加到暂存区。
    - [ ] 编写清晰的 Commit Message，例如 "feat: Complete initial version of Text2Poster generator"，并提交代码。